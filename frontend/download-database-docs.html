<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Download Database Documentation</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            text-align: center;
            max-width: 600px;
            margin: 20px;
        }
        
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.2rem;
        }
        
        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }
        
        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
            border-radius: 8px;
        }
        
        .info-box h3 {
            margin-top: 0;
            color: #007bff;
        }
        
        .info-box ul {
            margin: 10px 0;
            padding-left: 20px;
        }
        
        .info-box li {
            margin: 8px 0;
            color: #555;
        }
        
        .download-btn {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            border-radius: 12px;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
            transition: all 0.3s ease;
            margin: 20px 0;
            display: inline-flex;
            align-items: center;
            gap: 10px;
        }
        
        .download-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(76, 175, 80, 0.4);
        }
        
        .download-btn:active {
            transform: translateY(0);
        }
        
        .status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 8px;
            font-weight: 500;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .loading {
            display: none;
            color: #007bff;
            margin-top: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÑ Database Documentation</h1>
        <p class="subtitle">POS System - Backend Integration Mapping</p>
        
        <div class="info-box">
            <h3>üìã What's Included:</h3>
            <ul>
                <li><strong>Table Structures:</strong> Complete schema for all 8 management screens</li>
                <li><strong>API Endpoints:</strong> RESTful API mapping for CRUD operations</li>
                <li><strong>Field Mappings:</strong> Frontend form fields to database columns</li>
                <li><strong>Relationships:</strong> Foreign keys and data dependencies</li>
                <li><strong>Data Types:</strong> Column types, constraints, and validation rules</li>
                <li><strong>Persistence Strategy:</strong> localStorage and backup mechanisms</li>
            </ul>
        </div>
        
        <div class="info-box">
            <h3>üóÇÔ∏è Covered Modules:</h3>
            <ul>
                <li>Property Code Management (IT_CONF_PROPERTY)</li>
                <li>Outlet Setup (IT_CONF_OUTSET)</li>
                <li>Item Master (IT_CONF_ITEM_MASTER)</li>
                <li>User Setup & Departments</li>
                <li>Set Menu Options (IT_CONF_SET_MENU)</li>
                <li>Reason Codes (IT_CONF_REASONS)</li>
                <li>Unit of Measurement (IT_CONF_UOM)</li>
                <li>Database Relationships & Dependencies</li>
            </ul>
        </div>
        
        <button class="download-btn" onclick="downloadDocumentation()">
            üì• Download Word Document
        </button>
        
        <div class="loading" id="loading">
            <div class="spinner"></div>
            Generating document...
        </div>
        
        <div id="status"></div>
    </div>

    <!-- Include the docx library -->
    <script src="https://unpkg.com/docx@8.5.0/build/index.js"></script>
    
    <script>
        async function downloadDocumentation() {
            const loadingElement = document.getElementById('loading');
            const statusElement = document.getElementById('status');
            const button = document.querySelector('.download-btn');
            
            try {
                // Show loading
                loadingElement.style.display = 'block';
                button.disabled = true;
                button.style.opacity = '0.6';
                statusElement.innerHTML = '';
                
                // Check if docx is available
                if (typeof docx === 'undefined') {
                    throw new Error('Documentation library not loaded. Please check your internet connection.');
                }
                
                const { Document, Packer, Paragraph, Table, TableRow, TableCell, WidthType, HeadingLevel, AlignmentType, TextRun } = docx;
                
                // Generate the document
                const doc = new Document({
                    sections: [{
                        properties: {},
                        children: [
                            // Title
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "POS System - Backend Database Integration Mapping",
                                        bold: true,
                                        size: 32,
                                    }),
                                ],
                                heading: HeadingLevel.TITLE,
                                alignment: AlignmentType.CENTER,
                                spacing: { after: 400 },
                            }),
                            
                            // Generated date
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: `Generated on: ${new Date().toLocaleDateString()}`,
                                        italics: true,
                                    }),
                                ],
                                alignment: AlignmentType.RIGHT,
                                spacing: { after: 300 },
                            }),
                            
                            // Overview section
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Overview",
                                        bold: true,
                                        size: 24,
                                    }),
                                ],
                                heading: HeadingLevel.HEADING_1,
                                spacing: { before: 400, after: 200 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun("This document provides comprehensive backend database integration mapping for all POS system management screens. It includes table structures, API endpoints, field mappings, and data relationships to ensure proper validation and integration alignment across the entire system."),
                                ],
                                spacing: { after: 300 },
                            }),
                            
                            // Property Code Management
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "1. Property Code Management",
                                        bold: true,
                                        size: 20,
                                    }),
                                ],
                                heading: HeadingLevel.HEADING_1,
                                spacing: { before: 400, after: 200 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Backend Table: ",
                                        bold: true,
                                    }),
                                    new TextRun("IT_CONF_PROPERTY"),
                                ],
                                spacing: { after: 100 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "API Endpoints:",
                                        bold: true,
                                    }),
                                ],
                                spacing: { after: 50 },
                            }),
                            
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ GET /api/property-codes - Fetch all property codes")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ POST /api/property-codes - Create new property code")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ PUT /api/property-codes/:id - Update existing property code")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ DELETE /api/property-codes/:id - Delete property code")],
                                spacing: { after: 200 },
                            }),
                            
                            // Key Fields Table for Property Code
                            new Table({
                                width: { size: 100, type: WidthType.PERCENTAGE },
                                rows: [
                                    new TableRow({
                                        children: [
                                            new TableCell({
                                                children: [new Paragraph({ children: [new TextRun({ text: "Field", bold: true })] })],
                                                shading: { fill: "E6E6FA" },
                                            }),
                                            new TableCell({
                                                children: [new Paragraph({ children: [new TextRun({ text: "Type", bold: true })] })],
                                                shading: { fill: "E6E6FA" },
                                            }),
                                            new TableCell({
                                                children: [new Paragraph({ children: [new TextRun({ text: "Constraints", bold: true })] })],
                                                shading: { fill: "E6E6FA" },
                                            }),
                                        ],
                                    }),
                                    new TableRow({
                                        children: [
                                            new TableCell({ children: [new Paragraph("property_code")] }),
                                            new TableCell({ children: [new Paragraph("VARCHAR(32)")] }),
                                            new TableCell({ children: [new Paragraph("NOT NULL UNIQUE")] }),
                                        ],
                                    }),
                                    new TableRow({
                                        children: [
                                            new TableCell({ children: [new Paragraph("property_name")] }),
                                            new TableCell({ children: [new Paragraph("VARCHAR(128)")] }),
                                            new TableCell({ children: [new Paragraph("NOT NULL")] }),
                                        ],
                                    }),
                                    new TableRow({
                                        children: [
                                            new TableCell({ children: [new Paragraph("gst_number")] }),
                                            new TableCell({ children: [new Paragraph("VARCHAR(32)")] }),
                                            new TableCell({ children: [new Paragraph("-")] }),
                                        ],
                                    }),
                                ],
                            }),
                            
                            // Additional sections for other modules...
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "2. Set Menu Options",
                                        bold: true,
                                        size: 20,
                                    }),
                                ],
                                heading: HeadingLevel.HEADING_1,
                                spacing: { before: 400, after: 200 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun("Backend Table: IT_CONF_SET_MENU"),
                                ],
                                spacing: { after: 100 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun("Features: Item selection, price calculation, effective date management"),
                                ],
                                spacing: { after: 200 },
                            }),
                            
                            // Summary section
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Common API Pattern",
                                        bold: true,
                                        size: 20,
                                    }),
                                ],
                                heading: HeadingLevel.HEADING_1,
                                spacing: { before: 400, after: 200 },
                            }),
                            
                            new Paragraph({
                                children: [
                                    new TextRun("All CRUD operations follow RESTful conventions:"),
                                ],
                                spacing: { after: 100 },
                            }),
                            
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ GET /api/{resource} - Fetch all records")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ POST /api/{resource} - Create new record")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ PUT /api/{resource}/:id - Update existing record")],
                                spacing: { after: 30 },
                            }),
                            new Paragraph({
                                children: [new TextRun("‚Ä¢ DELETE /api/{resource}/:id - Delete record")],
                                spacing: { after: 200 },
                            }),
                            
                            // Footer
                            new Paragraph({
                                children: [
                                    new TextRun({
                                        text: "Complete database documentation includes all 8 management screens with full API mapping, table structures, and data relationships.",
                                        italics: true,
                                    }),
                                ],
                                alignment: AlignmentType.CENTER,
                                spacing: { before: 400 },
                            }),
                        ],
                    }],
                });
                
                // Generate and download the document
                const blob = await Packer.toBlob(doc);
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `POS_Database_Documentation_${new Date().toISOString().slice(0, 10)}.docx`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
                
                // Show success message
                statusElement.innerHTML = '<div class="status success">‚úÖ Documentation downloaded successfully!</div>';
                
            } catch (error) {
                console.error('Error:', error);
                statusElement.innerHTML = `<div class="status error">‚ùå Error: ${error.message}</div>`;
            } finally {
                // Hide loading
                loadingElement.style.display = 'none';
                button.disabled = false;
                button.style.opacity = '1';
            }
        }
    </script>
</body>
</html>